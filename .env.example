# =============================================================================
# Veralux Receptionist - Environment Configuration
# =============================================================================
# Copy this file to .env and update the values below.
# IMPORTANT: Never commit .env to version control!
# =============================================================================

# -----------------------------------------------------------------------------
# Deployment Version & Registry
# -----------------------------------------------------------------------------
# Pin to a specific version for reproducible deployments
# Use: openssl rand -hex 4  to generate a short tag, or use semver (e.g., 0.1.0)
VERSION=0.1.0
REGISTRY=ghcr.io/nick-veraluxai

# -----------------------------------------------------------------------------
# Database Configuration (PostgreSQL)
# -----------------------------------------------------------------------------
POSTGRES_USER=veralux
POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD
POSTGRES_DB=veralux

# -----------------------------------------------------------------------------
# Application Security
# -----------------------------------------------------------------------------
# Generate a secure secret: openssl rand -base64 32
JWT_SECRET=CHANGE_ME_GENERATE_SECURE_SECRET

# Encryption key for tenant secrets stored in DB
# Generate: openssl rand -hex 24
SECRET_ENCRYPTION_KEY=CHANGE_ME_GENERATE_SECURE_KEY
SECRET_MANAGER=db

# -----------------------------------------------------------------------------
# Application URLs
# -----------------------------------------------------------------------------
# Base URL where the control panel is accessible
BASE_URL=http://localhost:4000

# Public URL where the runtime is accessible (for Telnyx webhooks)
PUBLIC_BASE_URL=https://your-domain.com
# Public URL for audio file access
AUDIO_PUBLIC_BASE_URL=https://your-domain.com/audio

# CORS origins allowed to access the admin panel (comma-separated)
ADMIN_ALLOWED_ORIGINS=http://localhost:4000

# -----------------------------------------------------------------------------
# Port Configuration (change if ports conflict)
# -----------------------------------------------------------------------------
CONTROL_PORT=4000
RUNTIME_PORT=4001
# POSTGRES_PORT=5432  # Uncomment to expose for debugging

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
LOG_LEVEL=info

# -----------------------------------------------------------------------------
# Telnyx Configuration (Required for Voice Runtime)
# Get these from https://portal.telnyx.com
# -----------------------------------------------------------------------------
TELNYX_API_KEY=CHANGE_ME
TELNYX_PUBLIC_KEY=CHANGE_ME
TELNYX_PHONE_NUMBER=

# Webhook signature verification (MUST be true in production)
TELNYX_VERIFY_SIGNATURES=true

# Audio codecs accepted from Telnyx (AMR-WB provides better quality)
TELNYX_ACCEPT_CODECS=PCMU,AMR-WB
TELNYX_AMRWB_DECODE=true

# TTS output sample rate for PSTN playback
# 24000 = let Telnyx downsample from 24kHz (best quality)
# 16000 = pre-downsample to 16kHz (lower latency)
PLAYBACK_PSTN_SAMPLE_RATE=24000

# -----------------------------------------------------------------------------
# LLM Configuration (default: openai)
# -----------------------------------------------------------------------------
LLM_PROVIDER=openai
OPENAI_API_KEY=CHANGE_ME
OPENAI_MODEL=gpt-4o-mini

# -----------------------------------------------------------------------------
# Stripe (optional — enables payment processing)
# Get keys from https://dashboard.stripe.com/apikeys
# -----------------------------------------------------------------------------
STRIPE_SECRET_KEY=
STRIPE_PUBLISHABLE_KEY=
STRIPE_WEBHOOK_SECRET=

# -----------------------------------------------------------------------------
# TTS Configuration
# -----------------------------------------------------------------------------
# TTS engine: coqui_xtts (default) or kokoro_http
TTS_MODE=coqui_xtts
KOKORO_URL=http://kokoro:7001
XTTS_URL=http://xtts:7002
COQUI_XTTS_URL=http://xtts:7002/tts

# -----------------------------------------------------------------------------
# Media/Audio Configuration
# -----------------------------------------------------------------------------
# Token for authenticating media stream connections
MEDIA_STREAM_TOKEN=CHANGE_ME_GENERATE_SECURE_TOKEN
AUDIO_STORAGE_DIR=/app/audio

# -----------------------------------------------------------------------------
# Speech-to-Text Settings
# -----------------------------------------------------------------------------
STT_CHUNK_MS=100
STT_SILENCE_MS=700
DEAD_AIR_MS=10000

# -----------------------------------------------------------------------------
# Rate Limiting / Capacity
# -----------------------------------------------------------------------------
GLOBAL_CONCURRENCY_CAP=100
TENANT_CONCURRENCY_CAP_DEFAULT=10
TENANT_CALLS_PER_MIN_CAP_DEFAULT=60
CAPACITY_TTL_SECONDS=3600

# -----------------------------------------------------------------------------
# GPU Services Configuration (Optional)
# Enable GPU services with: docker compose --profile gpu up
# -----------------------------------------------------------------------------

# Whisper (Speech-to-Text)
WHISPER_PORT=9000
WHISPER_MODEL_SIZE=base

# Kokoro (Voice Synthesis)
KOKORO_PORT=7001
KOKORO_VOICE_ID=default

# XTTS (Text-to-Speech)
XTTS_PORT=7002
XTTS_LANGUAGE=en

# -----------------------------------------------------------------------------
# Tunnel Configuration (Optional)
# Use ONE of: Cloudflare (recommended) or ngrok (dev/testing)
# -----------------------------------------------------------------------------

# Ngrok (for tunneling - get token from https://dashboard.ngrok.com)
NGROK_AUTHTOKEN=

# Cloudflare Tunnel (recommended - requires config in ./cloudflared/)
# Go to: Zero Trust → Networks → Tunnels → Create tunnel
CLOUDFLARE_TUNNEL_TOKEN=

# -----------------------------------------------------------------------------
# SMTP Configuration (Optional — enables workflow email actions)
# -----------------------------------------------------------------------------
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASS=
SMTP_FROM=noreply@veralux.ai
