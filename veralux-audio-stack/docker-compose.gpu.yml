# GPU override for veralux-audio-stack
# Usage: docker compose -f docker-compose.yml -f docker-compose.gpu.yml up -d
#
# Requires:
#   - NVIDIA Container Toolkit installed
#   - nvidia-docker2 or Docker 19.03+ with GPU support

services:
  xtts:
    build:
      dockerfile: Dockerfile.xtts.gpu
    environment:
      - XTTS_USE_GPU=true
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]

  whisper:
    build:
      dockerfile: Dockerfile.whisper.gpu
    environment:
      - WHISPER_DEVICE=cuda
      - WHISPER_COMPUTE_TYPE=float16
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]
